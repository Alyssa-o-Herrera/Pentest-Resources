# Python script used for testing sensors based on outbound traffic patterns
# In this example we just have a UA string we replace as needed to test sensors
# This script can be controlled via a cron job for ever 1 hour/10min etc. to emulate C2


#!/usr/bin/python
import sys
import requests
import time
 
URLs = ['external_C2_0', 'external_C2_1'] # Python list to define external C2 servers
log_file = open('[PATH_TO_LOG_FILE]', 'a')  # Replace with full path to log file

for URL in URLs:
    Host = URL.split('/')[2]
    header = {'User-Agent':'dGhpcyBpcyBhIHRlc3Qgc3RyaW5nCg=='}  # Test UA string for IDS
    try:                   
        response=requests.head(URL, headers=header, allow_redirects=False)
        print "[+] "+URL+" ["+str(response.status_code)+"]"
        log_file.write("[+] "+str((time.strftime("%m/%d/%Y")))+" "+str((time.strftime("%H:%M:%S")))+" "+URL+" ["+str(response.status_code)+"] "+"\n")
    except Exception as e: 
        print e
        log_file.write("[+] "+str((time.strftime("%m/%d/%Y")))+" "+str((time.strftime("%H:%M:%S")))+" "+URL+" "+str(e)+"\n")

log_file.close()
